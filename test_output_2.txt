
> xivdyetools@2.4.6 test
> vitest src/components/__tests__/color-matcher-tool.test.ts


[1m[46m RUN [49m[22m [36mv4.0.13 [39m[90mC:/Users/DrawF/OneDrive/Projects/CodingProjects/XIVProjects/xivdyetools-web-app[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mâœ… Theme service initialized: standard-light

[90mstderr[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mIndexedDB is not supported in this browser

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mâœ… APIService initialized from xivdyetools-core with IndexedDB cache

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mIndexedDB cache backend initialized

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mâœ… Dye database loaded: 136 dyes
âœ… DyeService initialized from xivdyetools-core

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mDetected browser locale: en

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mLoaded web app translations for: en

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mLocale changed to: en

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts
[22m[39mLanguage service initialized: en

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenders key sections after initialization
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mtrue[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mupdates sample size value on slider input
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mtrue[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mhandles toggle-prices events and updates internal state
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mtrue[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mdelegates to ImageZoomController when image-loaded event fires
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mdelegates to ImageZoomController when image-loaded event fires
[22m[39mDEBUG: test body html: <div id="test-container"><div class="space-y-8"><div class="space-y-4 text-center mb-8"><h2 class="text-2xl font-bold text-gray-900 dark:text-white flex items-center justify-center gap-2">Color Matcher</h2><p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">Upload an image or select a color to find the closest matching FFXIV dyes.</p></div><div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Image Upload</h3><div id="image-upload-container"></div></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Manual Color Input</h3><div id="color-picker-container"></div></div></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Sample Settings</h3><div class="space-y-2"><label class="block text-sm font-semibold text-gray-700 dark:text-gray-300">Sample Size (for image color averaging)<button type="button" class="info-tooltip-icon inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full cursor-help transition-colors" aria-label="More information" tabindex="0" data-tooltip-id="tooltip_1764635676097_ghg6rp1" aria-describedby="tooltip_1764635676097_ghg6rp1">â“˜</button></label><div class="flex items-center gap-4"><input class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none" type="range" min="1" max="64" value="5" id="sample-size-input" style="accent-color: var(--theme-primary);"><div class="text-lg font-bold text-gray-900 dark:text-white w-12 text-center" id="sample-size-value">5</div></div><p class="text-xs text-gray-600 dark:text-gray-400">Larger sizes produce more accurate color matching but ignore fine details</p></div></div><div id="recent-colors-wrapper"></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><div id="colormatcher-filters-container"></div></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><div id="market-board-container"></div></div><div id="results-container"></div></div></div><div id="test-container"><div class="space-y-8"><div class="space-y-4 text-center mb-8"><h2 class="text-2xl font-bold text-gray-900 dark:text-white flex items-center justify-center gap-2">Color Matcher</h2><p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">Upload an image or select a color to find the closest matching FFXIV dyes.</p></div><div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Image Upload</h3><div id="image-upload-container"></div></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Manual Color Input</h3><div id="color-picker-container"></div></div></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Sample Settings</h3><div class="space-y-2"><label class="block text-sm font-semibold text-gray-700 dark:text-gray-300">Sample Size (for image color averaging)<button type="button" class="info-tooltip-icon inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full cursor-help transition-colors" aria-label="More information" tabindex="0" data-tooltip-id="tooltip_1764635676125_5yf671h" aria-describedby="tooltip_1764635676125_5yf671h">â“˜</button></label><div class="flex items-center gap-4"><input class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none" type="range" min="1" max="64" value="5" id="sample-size-input" style="accent-color: var(--theme-primary);"><div class="text-lg font-bold text-gray-900 dark:text-white w-12 text-center" id="sample-size-value">5</div></div><p class="text-xs text-gray-600 dark:text-gray-400">Larger sizes produce more accurate color matching but ignore fine details</p></div></div><div id="recent-colors-wrapper"></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><div id="colormatcher-filters-container"></div></div><div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"><div id="market-board-container"></div></div><div id="results-container"></div></div></div>

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor method[2m > [22m[2mshould populate matchedDyes array after matching
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor method[2m > [22m[2mshould store lastSampledColor when matching
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor method[2m > [22m[2mshould display best match section in results
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor method[2m > [22m[2mshould display similar dyes count
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor method[2m > [22m[2mshould handle no closest dye found
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor method[2m > [22m[2mshould call findClosestDye with correct hex
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould create card element with dye info
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould include sampled color swatch
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould include dye color swatch
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould include category badge
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould include copy hex button
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould display price when showPrices is true and price exists
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard method[2m > [22m[2mshould display N/A when showPrices is true but no price data
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mshowToast method[2m > [22m[2mshould create toast container if not exists
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mshowToast method[2m > [22m[2mshould display success toast with green background
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mshowToast method[2m > [22m[2mshould display error toast with red background
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mshowToast method[2m > [22m[2mshould display info toast with blue background
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mshowToast method[2m > [22m[2mshould include message text in toast
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mgetState method[2m > [22m[2mshould return matchedDyeCount
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mgetState method[2m > [22m[2mshould return sampleSize
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mgetState method[2m > [22m[2mshould return 0 for empty matchedDyes
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handling[2m > [22m[2mshould handle server-changed event
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handling[2m > [22m[2mshould handle categories-changed event
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handling[2m > [22m[2mshould handle refresh-requested event
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handling[2m > [22m[2mshould not fetch prices when showPrices is false
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handling[2m > [22m[2mshould handle color-selected event from color picker
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mlifecycle[2m > [22m[2mshould initialize all child components
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mlifecycle[2m > [22m[2mshould cleanup on destroy
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mlifecycle[2m > [22m[2mshould cleanup on destroy
[22m[39mDEBUG: render started

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mlifecycle[2m > [22m[2mshould handle update cycle
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mlifecycle[2m > [22m[2mshould handle update cycle
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m
DEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2medge cases[2m > [22m[2mshould handle empty results container gracefully
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2medge cases[2m > [22m[2mshould handle matchColor without results container
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrefreshResults branch coverage[2m > [22m[2mshould handle empty matchedDyes gracefully
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrefreshResults branch coverage[2m > [22m[2mshould handle missing results section
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrefreshResults branch coverage[2m > [22m[2mshould render other matches when present
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrefreshResults branch coverage[2m > [22m[2mshould use lastSampledColor for refreshing
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor filter branch coverage[2m > [22m[2mshould match without filters when dyeFilters is null
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mmatchColor filter branch coverage[2m > [22m[2mshould handle no similar dyes found
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mfetchPricesForMatchedDyes branch coverage[2m > [22m[2mshould return early when marketBoard is null
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mfetchPricesForMatchedDyes branch coverage[2m > [22m[2mshould return early when showPrices is false
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mfetchPricesForMatchedDyes branch coverage[2m > [22m[2mshould return early when matchedDyes is empty
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mtoggle-prices event branch coverage[2m > [22m[2mshould clear priceData when showPrices is toggled off
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mtoggle-prices event branch coverage[2m > [22m[2mshould not fetch prices when matchedDyes is empty
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard branch coverage[2m > [22m[2mshould not render price section when showPrices is false
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard branch coverage[2m > [22m[2mshould handle copy button click with clipboard API
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mrenderDyeCard branch coverage[2m > [22m[2mshould use fallback when clipboard API fails
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handler branch coverage[2m > [22m[2mshould not fetch prices on server-changed when matchedDyes is empty
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handler branch coverage[2m > [22m[2mshould not fetch prices on categories-changed when matchedDyes is empty
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mevent handler branch coverage[2m > [22m[2mshould not fetch prices on refresh-requested when matchedDyes is empty
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2msample size slider branch coverage[2m > [22m[2mshould handle missing value display element
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mimage error handling branch coverage[2m > [22m[2mshould handle error event from image upload
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mimage error handling branch coverage[2m > [22m[2mshould handle error event without message
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2monMount function coverage[2m > [22m[2mshould call onMount without throwing
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2monMount function coverage[2m > [22m[2mshould subscribe to language changes
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mdestroy with child components[2m > [22m[2mshould destroy imageUpload if exists
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mdestroy with child components[2m > [22m[2mshould destroy colorPicker if exists
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mdestroy with child components[2m > [22m[2mshould destroy marketBoard if exists
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

[90mstdout[2m | src/components/__tests__/color-matcher-tool.test.ts[2m > [22m[2mColorMatcherTool[2m > [22m[2mdestroy with child components[2m > [22m[2mshould handle destroy when child components are null
[22m[39mDEBUG: bindEvents imageUploadContainer found: [33mfalse[39m

 [31mâ¯[39m src/components/__tests__/color-matcher-tool.test.ts [2m([22m[2m61 tests[22m[2m | [22m[31m28 failed[39m[2m)[22m[33m 2351[2mms[22m[39m
     [32mâœ“[39m renders key sections after initialization[32m 35[2mms[22m[39m
     [32mâœ“[39m updates sample size value on slider input[32m 10[2mms[22m[39m
[31m     [31mÃ—[31m handles toggle-prices events and updates internal state[39m[32m 28[2mms[22m[39m
[31m     [31mÃ—[31m delegates to ImageZoomController when image-loaded event fires[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should populate matchedDyes array after matching[39m[32m 7[2mms[22m[39m
[31m       [31mÃ—[31m should store lastSampledColor when matching[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should display best match section in results[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should display similar dyes count[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should handle no closest dye found[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should call findClosestDye with correct hex[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should create card element with dye info[32m 13[2mms[22m[39m
       [32mâœ“[39m should include sampled color swatch[32m 4[2mms[22m[39m
       [32mâœ“[39m should include dye color swatch[32m 3[2mms[22m[39m
       [32mâœ“[39m should include category badge[32m 3[2mms[22m[39m
       [32mâœ“[39m should include copy hex button[32m 3[2mms[22m[39m
       [32mâœ“[39m should display price when showPrices is true and price exists[32m 23[2mms[22m[39m
       [32mâœ“[39m should display N/A when showPrices is true but no price data[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should create toast container if not exists[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should display success toast with green background[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m should display error toast with red background[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should display info toast with blue background[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should include message text in toast[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should return matchedDyeCount[32m 2[2mms[22m[39m
       [32mâœ“[39m should return sampleSize[32m 2[2mms[22m[39m
       [32mâœ“[39m should return 0 for empty matchedDyes[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should handle server-changed event[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should handle categories-changed event[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should handle refresh-requested event[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should not fetch prices when showPrices is false[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should handle color-selected event from color picker[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should initialize all child components[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should cleanup on destroy[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle update cycle[32m 5[2mms[22m[39m
       [32mâœ“[39m should handle empty results container gracefully[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle matchColor without results container[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle empty matchedDyes gracefully[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle missing results section[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should render other matches when present[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should use lastSampledColor for refreshing[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should match without filters when dyeFilters is null[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should handle no similar dyes found[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should return early when marketBoard is null[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should return early when showPrices is false[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should return early when matchedDyes is empty[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should clear priceData when showPrices is toggled off[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should not fetch prices when matchedDyes is empty[32m 2[2mms[22m[39m
       [32mâœ“[39m should not render price section when showPrices is false[32m 3[2mms[22m[39m
       [32mâœ“[39m should handle copy button click with clipboard API[32m 22[2mms[22m[39m
       [32mâœ“[39m should use fallback when clipboard API fails[32m 16[2mms[22m[39m
       [32mâœ“[39m should not fetch prices on server-changed when matchedDyes is empty[32m 2[2mms[22m[39m
       [32mâœ“[39m should not fetch prices on categories-changed when matchedDyes is empty[32m 2[2mms[22m[39m
       [32mâœ“[39m should not fetch prices on refresh-requested when matchedDyes is empty[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should handle missing value display element[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should handle error event from image upload[39m[33m 1026[2mms[22m[39m
[31m       [31mÃ—[31m should handle error event without message[39m[33m 1018[2mms[22m[39m
       [32mâœ“[39m should call onMount without throwing[32m 2[2mms[22m[39m
       [32mâœ“[39m should subscribe to language changes[32m 2[2mms[22m[39m
       [32mâœ“[39m should destroy imageUpload if exists[32m 2[2mms[22m[39m
       [32mâœ“[39m should destroy colorPicker if exists[32m 2[2mms[22m[39m
       [32mâœ“[39m should destroy marketBoard if exists[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle destroy when child components are null[32m 2[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 28 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mhandles toggle-prices events and updates internal state
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'clear')[39m
[36m [2mâ¯[22m ColorMatcherTool.destroy src/components/color-matcher-tool.ts:[2m763:20[22m[39m
    [90m761| [39m    [90m// Clear arrays and Maps[39m
    [90m762| [39m    [35mthis[39m[33m.[39mmatchedDyes [33m=[39m [][33m;[39m
    [90m763| [39m    [35mthis[39m[33m.[39mpriceData[33m.[39m[34mclear[39m()[33m;[39m
    [90m   | [39m                   [31m^[39m
    [90m764| [39m
    [90m765| [39m    [35msuper[39m[33m.[39m[34mdestroy[39m()[33m;[39m
[90m [2mâ¯[22m Module.cleanupComponent src/components/__tests__/test-utils.ts:[2m60:13[22m[39m
[90m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m179:7[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mdelegates to ImageZoomController when image-loaded event fires
[31m[1mTypeError[22m: Cannot read properties of null (reading 'dispatchEvent')[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m258:22[22m[39m
    [90m256| [39m    [35mconst[39m image [33m=[39m document[33m.[39m[34mcreateElement[39m([32m'img'[39m)[33m;[39m
    [90m257| [39m
    [90m258| [39m    uploadContainer!.dispatchEvent(new CustomEvent('image-loaded', { dâ€¦
    [90m   | [39m                     [31m^[39m
    [90m259| [39m
    [90m260| [39m    expect(imageZoomControllerSetImageMock).toHaveBeenCalledWith(imageâ€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor method[2m > [22mshould populate matchedDyes array after matching
[31m[1mAssertionError[22m: expected [] to have a length of 3 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 3[39m
[31m+ 0[39m

[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m288:27[22m[39m
    [90m286| [39m
    [90m287| [39m      const matchedDyes = (instance as unknown as ComponentWithPrivateâ€¦
    [90m288| [39m      [34mexpect[39m(matchedDyes)[33m.[39m[34mtoHaveLength[39m([34m3[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m289| [39m      [34mexpect[39m(matchedDyes[[34m0[39m][33m.[39mname)[33m.[39m[34mtoBe[39m([32m'Closest Dye'[39m)[33m;[39m
    [90m290| [39m    })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor method[2m > [22mshould store lastSampledColor when matching
[31m[1mAssertionError[22m: expected '' to be '#ABCDEF' // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- #ABCDEF[39m

[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m297:78[22m[39m
    [90m295| [39m      (instance as unknown as ComponentWithPrivate).matchColor('#ABCDEâ€¦
    [90m296| [39m
    [90m297| [39m      expect((instance as unknown as ComponentWithPrivate).lastSampledâ€¦
    [90m   | [39m                                                                             [31m^[39m
    [90m298| [39m    })[33m;[39m
    [90m299| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor method[2m > [22mshould display best match section in results
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m306:45[22m[39m
    [90m304| [39m
    [90m305| [39m      const resultsContainer = container.querySelector('#results-contaâ€¦
    [90m306| [39m      [34mexpect[39m(resultsContainer[33m?.[39mtextContent)[33m.[39m[34mtoContain[39m([32m'Best Match'[39m)[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m307| [39m      [34mexpect[39m(resultsContainer[33m?.[39mtextContent)[33m.[39m[34mtoContain[39m([32m'Closest Dye'[39m)[33m;[39m
    [90m308| [39m    })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor method[2m > [22mshould display similar dyes count
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m316:45[22m[39m
    [90m314| [39m
    [90m315| [39m      const resultsContainer = container.querySelector('#results-contaâ€¦
    [90m316| [39m      [34mexpect[39m(resultsContainer[33m?.[39mtextContent)[33m.[39m[34mtoContain[39m([32m'Similar'[39m)[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m317| [39m    })[33m;[39m
    [90m318| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor method[2m > [22mshould handle no closest dye found
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m326:45[22m[39m
    [90m324| [39m
    [90m325| [39m      const resultsContainer = container.querySelector('#results-contaâ€¦
    [90m326| [39m      expect(resultsContainer?.textContent).toContain('No matching dyeâ€¦
    [90m   | [39m                                            [31m^[39m
    [90m327| [39m    })[33m;[39m
    [90m328| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor method[2m > [22mshould call findClosestDye with correct hex
[31m[1mAssertionError[22m: expected "findClosestDye" to be called with arguments: [ '#AABBCC' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m335:19[22m[39m
    [90m333| [39m      (instance as unknown as ComponentWithPrivate).matchColor('#AABBCâ€¦
    [90m334| [39m
    [90m335| [39m      [34mexpect[39m(spy)[33m.[39m[34mtoHaveBeenCalledWith[39m([32m'#AABBCC'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m336| [39m    })[33m;[39m
    [90m337| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[8/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mshowToast method[2m > [22mshould create toast container if not exists
[31m[1mTypeError[22m: instance.showToast is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m441:53[22m[39m
    [90m439| [39m      [35mconst[39m instance [33m=[39m [35mawait[39m [34mcreateComponent[39m()[33m;[39m
    [90m440| [39m
    [90m441| [39m      (instance as unknown as ComponentWithPrivate).showToast('Test meâ€¦
    [90m   | [39m                                                    [31m^[39m
    [90m442| [39m
    [90m443| [39m      const toastContainer = document.getElementById('toast-container'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[9/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mshowToast method[2m > [22mshould display success toast with green background
[31m[1mTypeError[22m: instance.showToast is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m450:53[22m[39m
    [90m448| [39m      [35mconst[39m instance [33m=[39m [35mawait[39m [34mcreateComponent[39m()[33m;[39m
    [90m449| [39m
    [90m450| [39m      (instance as unknown as ComponentWithPrivate).showToast('Successâ€¦
    [90m   | [39m                                                    [31m^[39m
    [90m451| [39m
    [90m452| [39m      const toastContainer = document.getElementById('toast-container'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[10/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mshowToast method[2m > [22mshould display error toast with red background
[31m[1mTypeError[22m: instance.showToast is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m461:53[22m[39m
    [90m459| [39m      [35mconst[39m instance [33m=[39m [35mawait[39m [34mcreateComponent[39m()[33m;[39m
    [90m460| [39m
    [90m461| [39m      (instance as unknown as ComponentWithPrivate).showToast('Error!'â€¦
    [90m   | [39m                                                    [31m^[39m
    [90m462| [39m
    [90m463| [39m      const toastContainer = document.getElementById('toast-container'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[11/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mshowToast method[2m > [22mshould display info toast with blue background
[31m[1mTypeError[22m: instance.showToast is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m472:53[22m[39m
    [90m470| [39m      [35mconst[39m instance [33m=[39m [35mawait[39m [34mcreateComponent[39m()[33m;[39m
    [90m471| [39m
    [90m472| [39m      (instance as unknown as ComponentWithPrivate).showToast('Info meâ€¦
    [90m   | [39m                                                    [31m^[39m
    [90m473| [39m
    [90m474| [39m      const toastContainer = document.getElementById('toast-container'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[12/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mshowToast method[2m > [22mshould include message text in toast
[31m[1mTypeError[22m: instance.showToast is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m483:53[22m[39m
    [90m481| [39m      [35mconst[39m instance [33m=[39m [35mawait[39m [34mcreateComponent[39m()[33m;[39m
    [90m482| [39m
    [90m483| [39m      (instance as unknown as ComponentWithPrivate).showToast('Custom â€¦
    [90m   | [39m                                                    [31m^[39m
    [90m484| [39m
    [90m485| [39m      const toastContainer = document.getElementById('toast-container'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[13/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mevent handling[2m > [22mshould handle server-changed event
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m544:31[22m[39m
    [90m542| [39m
    [90m543| [39m      [90m// Should trigger price fetch (async)[39m
    [90m544| [39m      [34mexpect[39m(mockFetchPrices)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m545| [39m    })[33m;[39m
    [90m546| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[14/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mevent handling[2m > [22mshould handle categories-changed event
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m556:31[22m[39m
    [90m554| [39m      marketContainer?.dispatchEvent(new CustomEvent('categories-changâ€¦
    [90m555| [39m
    [90m556| [39m      [34mexpect[39m(mockFetchPrices)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m557| [39m    })[33m;[39m
    [90m558| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[15/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mevent handling[2m > [22mshould handle refresh-requested event
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m568:31[22m[39m
    [90m566| [39m      marketContainer?.dispatchEvent(new CustomEvent('refresh-requesteâ€¦
    [90m567| [39m
    [90m568| [39m      [34mexpect[39m(mockFetchPrices)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m569| [39m    })[33m;[39m
    [90m570| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[16/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mevent handling[2m > [22mshould handle color-selected event from color picker
[31m[1mAssertionError[22m: expected "findClosestDye" to be called with arguments: [ '#AABBCC' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m595:41[22m[39m
    [90m593| [39m      )[33m;[39m
    [90m594| [39m
    [90m595| [39m      expect(dyeService.findClosestDye).toHaveBeenCalledWith('#AABBCC'â€¦
    [90m   | [39m                                        [31m^[39m
    [90m596| [39m    })[33m;[39m
    [90m597| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[17/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mlifecycle[2m > [22mshould initialize all child components
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m609:34[22m[39m
    [90m607| [39m      [34mexpect[39m(imageUploadInitMock)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m608| [39m      [34mexpect[39m(colorPickerInitMock)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m609| [39m      [34mexpect[39m(loadServerDataMock)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                                 [31m^[39m
    [90m610| [39m      [34mexpect[39m(imageZoomControllerInitMock)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m611| [39m      [34mexpect[39m(recentColorsPanelInitMock)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[18/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mrefreshResults branch coverage[2m > [22mshould render other matches when present
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m716:45[22m[39m
    [90m714| [39m
    [90m715| [39m      const resultsContainer = container.querySelector('#results-contaâ€¦
    [90m716| [39m      [34mexpect[39m(resultsContainer[33m?.[39mtextContent)[33m.[39m[34mtoContain[39m([32m'Similar'[39m)[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m717| [39m    })[33m;[39m
    [90m718| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[19/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mrefreshResults branch coverage[2m > [22mshould use lastSampledColor for refreshing
[31m[1mAssertionError[22m: expected '#ABCDEF' to be '#FF0000' // Object.is equality[39m

Expected: [32m"#[7mFF0000[27m"[39m
Received: [31m"#[7mABCDEF[27m"[39m

[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m730:78[22m[39m
    [90m728| [39m
    [90m729| [39m      [90m// Should not throw[39m
    [90m730| [39m      expect((instance as unknown as ComponentWithPrivate).lastSampledâ€¦
    [90m   | [39m                                                                             [31m^[39m
    [90m731| [39m    })[33m;[39m
    [90m732| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[20/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mmatchColor filter branch coverage[2m > [22mshould handle no similar dyes found
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m762:45[22m[39m
    [90m760| [39m
    [90m761| [39m      const resultsContainer = container.querySelector('#results-contaâ€¦
    [90m762| [39m      [34mexpect[39m(resultsContainer[33m?.[39mtextContent)[33m.[39m[34mtoContain[39m([32m'Only Dye'[39m)[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m763| [39m      [90m// Should not have "Similar" section[39m
    [90m764| [39m      [90m// The section count confirms no similar dyes section was added[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[21/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mfetchPricesForMatchedDyes branch coverage[2m > [22mshould return early when marketBoard is null
[31m[1mTypeError[22m: instance.fetchPricesForMatchedDyes is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m783:59[22m[39m
    [90m781| [39m      (instance as unknown as ComponentWithPrivate).matchedDyes = [creâ€¦
    [90m782| [39m
    [90m783| [39m      await (instance as unknown as ComponentWithPrivate).fetchPricesFâ€¦
    [90m   | [39m                                                          [31m^[39m
    [90m784| [39m
    [90m785| [39m      [34mexpect[39m(mockFetchPrices)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[22/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mfetchPricesForMatchedDyes branch coverage[2m > [22mshould return early when showPrices is false
[31m[1mTypeError[22m: instance.fetchPricesForMatchedDyes is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m795:59[22m[39m
    [90m793| [39m      (instance as unknown as ComponentWithPrivate).matchedDyes = [creâ€¦
    [90m794| [39m
    [90m795| [39m      await (instance as unknown as ComponentWithPrivate).fetchPricesFâ€¦
    [90m   | [39m                                                          [31m^[39m
    [90m796| [39m
    [90m797| [39m      [34mexpect[39m(mockFetchPrices)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[23/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mfetchPricesForMatchedDyes branch coverage[2m > [22mshould return early when matchedDyes is empty
[31m[1mTypeError[22m: instance.fetchPricesForMatchedDyes is not a function[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m807:59[22m[39m
    [90m805| [39m      (instance [35mas[39m unknown [35mas[39m [33mComponentWithPrivate[39m)[33m.[39mmatchedDyes [33m=[39m [][33m;[39m
    [90m806| [39m
    [90m807| [39m      await (instance as unknown as ComponentWithPrivate).fetchPricesFâ€¦
    [90m   | [39m                                                          [31m^[39m
    [90m808| [39m
    [90m809| [39m      [34mexpect[39m(mockFetchPrices)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[24/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mtoggle-prices event branch coverage[2m > [22mshould clear priceData when showPrices is toggled off
[31m[1mAssertionError[22m: expected 1 to be +0 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 0[39m
[31m+ 1[39m

[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m831:76[22m[39m
    [90m829| [39m      )[33m;[39m
    [90m830| [39m
    [90m831| [39m      expect((instance as unknown as ComponentWithPrivate).priceData.sâ€¦
    [90m   | [39m                                                                           [31m^[39m
    [90m832| [39m    })[33m;[39m
    [90m833| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[25/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22msample size slider branch coverage[2m > [22mshould handle missing value display element
[31m[1mAssertionError[22m: expected [Function] to not throw an error but 'TypeError: Cannot set properties of nâ€¦' was thrown[39m

[32m- Expected:[39m 
undefined

[31m+ Received:[39m 
"TypeError: Cannot set properties of null (setting 'value')"

[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m976:14[22m[39m
    [90m974| [39m        slider[33m![39m[33m.[39mvalue [33m=[39m [32m'20'[39m[33m;[39m
    [90m975| [39m        slider[33m![39m[33m.[39m[34mdispatchEvent[39m([35mnew[39m [33mEvent[39m([32m'input'[39m))[33m;[39m
    [90m976| [39m      })[33m.[39mnot[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m977| [39m    })[33m;[39m
    [90m978| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[26/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mimage error handling branch coverage[2m > [22mshould handle error event from image upload
[31m[1mAssertionError[22m[39m: expected "vi.fn()" to be called with arguments: [ 'Test error message' ][90m

Number of calls: [1m0[22m
[39m

Ignored nodes: comments, script, style
[36m<html[39m
  [33mclass[39m=[32m"theme-standard-light"[39m
  [33mstyle[39m=[32m"--theme-primary: #8B1A1A; --theme-background: #D3D3D3; --theme-text: #1A1A1A; --theme-text-header: #FFFFFF; --theme-border: #6B1515; --theme-background-secondary: #E0E0E0; --theme-card-background: #F5F5F5; --theme-card-hover: #FFFFFF; --theme-text-muted: #4A4A4A;"[39m
[36m>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div[39m
      [33mid[39m=[32m"test-container"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"space-y-8"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-4 text-center mb-8"[39m
        [36m>[39m
          [36m<h2[39m
            [33mclass[39m=[32m"text-2xl font-bold text-gray-900 dark:text-white flex items-center justify-center gap-2"[39m
          [36m>[39m
            [0mColor Matcher[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"[39m
          [36m>[39m
            [0mUpload an image or select a color to find the closest matching FFXIV dyes.[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"grid grid-cols-1 lg:grid-cols-2 gap-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mImage Upload[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"image-upload-container"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mManual Color Input[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"color-picker-container"[39m
            [36m/>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
          [36m>[39m
            [0mSample Settings[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-2"[39m
          [36m>[39m
            [36m<label[39m
              [33mclass[39m=[32m"block text-sm font-semibold text-gray-700 dark:text-gray-300"[39m
            [36m>[39m
              [0mSample Size (for image color averaging)[0m
              [36m<button[39m
                [33maria-describedby[39m=[32m"tooltip_1764635676097_ghg6rp1"[39m
                [33maria-label[39m=[32m"More information"[39m
                [33mclass[39m=[32m"info-tooltip-icon inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full cursor-help transition-colors"[39m
                [33mdata-tooltip-id[39m=[32m"tooltip_1764635676097_ghg6rp1"[39m
                [33mtabindex[39m=[32m"0"[39m
                [33mtype[39m=[32m"button"[39m
              [36m>[39m
                [0mâ“˜[0m
              [36m</button>[39m
            [36m</label>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center gap-4"[39m
            [36m>[39m
              [36m<input[39m
                [33mclass[39m=[32m"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none"[39m
                [33mid[39m=[32m"sample-size-input"[39m
                [33mmax[39m=[32m"64"[39m
                [33mmin[39m=[32m"1"[39m
                [33mstyle[39m=[32m"accent-color: var(--theme-primary);"[39m
                [33mtype[39m=[32m"range"[39m
                [33mvalue[39m=[32m"5"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-lg font-bold text-gray-900 dark:text-white w-12 text-center"[39m
                [33mid[39m=[32m"sample-size-value"[39m
              [36m>[39m
                [0m5[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-600 dark:text-gray-400"[39m
            [36m>[39m
              [0mLarger sizes produce more accurate color matching but ignore fine details[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"recent-colors-wrapper"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"colormatcher-filters-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"market-board-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"results-container"[39m
        [36m/>[39m
      [36m</div>[39m
    [36m</div>[39m
    [36m<div[39m
      [33mid[39m=[32m"test-container"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"space-y-8"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-4 text-center mb-8"[39m
        [36m>[39m
          [36m<h2[39m
            [33mclass[39m=[32m"text-2xl font-bold text-gray-900 dark:text-white flex items-center justify-center gap-2"[39m
          [36m>[39m
            [0mColor Matcher[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"[39m
          [36m>[39m
            [0mUpload an image or select a color to find the closest matching FFXIV dyes.[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"grid grid-cols-1 lg:grid-cols-2 gap-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mImage Upload[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"image-upload-container"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mManual Color Input[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"color-picker-container"[39m
            [36m/>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
          [36m>[39m
            [0mSample Settings[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-2"[39m
          [36m>[39m
            [36m<label[39m
              [33mclass[39m=[32m"block text-sm font-semibold text-gray-700 dark:text-gray-300"[39m
            [36m>[39m
              [0mSample Size (for image color averaging)[0m
              [36m<button[39m
                [33maria-describedby[39m=[32m"tooltip_1764635676335_399kvsu"[39m
                [33maria-label[39m=[32m"More information"[39m
                [33mclass[39m=[32m"info-tooltip-icon inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full cursor-help transition-colors"[39m
                [33mdata-tooltip-id[39m=[32m"tooltip_1764635676335_399kvsu"[39m
                [33mtabindex[39m=[32m"0"[39m
                [33mtype[39m=[32m"button"[39m
              [36m>[39m
                [0mâ“˜[0m
              [36m</button>[39m
            [36m</label>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center gap-4"[39m
            [36m>[39m
              [36m<input[39m
                [33mclass[39m=[32m"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none"[39m
                [33mid[39m=[32m"sample-size-input"[39m
                [33mmax[39m=[32m"64"[39m
                [33mmin[39m=[32m"1"[39m
                [33mstyle[39m=[32m"accent-color: var(--theme-primary);"[39m
                [33mtype[39m=[32m"range"[39m
                [33mvalue[39m=[32m"5"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-lg font-bold text-gray-900 dark:text-white w-12 text-center"[39m
                [33mid[39m=[32m"sample-size-value"[39m
              [36m>[39m
                [0m5[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-600 dark:text-gray-400"[39m
            [36m>[39m
              [0mLarger sizes produce more accurate color matching but ignore fine details[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"recent-colors-wrapper"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"colormatcher-filters-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"market-board-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"results-container"[39m
        [36m/>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m998:39[22m[39m
    [90m996| [39m      [90m// Should show error toast[39m
    [90m997| [39m      [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m998| [39m        expect(toastServiceErrorMock).toHaveBeenCalledWith('Test errorâ€¦
    [90m   | [39m                                      [31m^[39m
    [90m999| [39m      })[33m;[39m
    [90m1000| [39m    })[33m;[39m
[90m [2mâ¯[22m runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:[2m47:12[22m[39m
[90m [2mâ¯[22m checkCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m124:77[22m[39m
[90m [2mâ¯[22m Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m118:16[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[27/28]â¯[22m[39m

[41m[1m FAIL [22m[49m src/components/__tests__/color-matcher-tool.test.ts[2m > [22mColorMatcherTool[2m > [22mimage error handling branch coverage[2m > [22mshould handle error event without message
[31m[1mAssertionError[22m[39m: expected "vi.fn()" to be called with arguments: [ 'Failed to load image' ][90m

Number of calls: [1m0[22m
[39m

Ignored nodes: comments, script, style
[36m<html[39m
  [33mclass[39m=[32m"theme-standard-light"[39m
  [33mstyle[39m=[32m"--theme-primary: #8B1A1A; --theme-background: #D3D3D3; --theme-text: #1A1A1A; --theme-text-header: #FFFFFF; --theme-border: #6B1515; --theme-background-secondary: #E0E0E0; --theme-card-background: #F5F5F5; --theme-card-hover: #FFFFFF; --theme-text-muted: #4A4A4A;"[39m
[36m>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div[39m
      [33mid[39m=[32m"test-container"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"space-y-8"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-4 text-center mb-8"[39m
        [36m>[39m
          [36m<h2[39m
            [33mclass[39m=[32m"text-2xl font-bold text-gray-900 dark:text-white flex items-center justify-center gap-2"[39m
          [36m>[39m
            [0mColor Matcher[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"[39m
          [36m>[39m
            [0mUpload an image or select a color to find the closest matching FFXIV dyes.[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"grid grid-cols-1 lg:grid-cols-2 gap-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mImage Upload[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"image-upload-container"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mManual Color Input[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"color-picker-container"[39m
            [36m/>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
          [36m>[39m
            [0mSample Settings[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-2"[39m
          [36m>[39m
            [36m<label[39m
              [33mclass[39m=[32m"block text-sm font-semibold text-gray-700 dark:text-gray-300"[39m
            [36m>[39m
              [0mSample Size (for image color averaging)[0m
              [36m<button[39m
                [33maria-describedby[39m=[32m"tooltip_1764635676097_ghg6rp1"[39m
                [33maria-label[39m=[32m"More information"[39m
                [33mclass[39m=[32m"info-tooltip-icon inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full cursor-help transition-colors"[39m
                [33mdata-tooltip-id[39m=[32m"tooltip_1764635676097_ghg6rp1"[39m
                [33mtabindex[39m=[32m"0"[39m
                [33mtype[39m=[32m"button"[39m
              [36m>[39m
                [0mâ“˜[0m
              [36m</button>[39m
            [36m</label>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center gap-4"[39m
            [36m>[39m
              [36m<input[39m
                [33mclass[39m=[32m"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none"[39m
                [33mid[39m=[32m"sample-size-input"[39m
                [33mmax[39m=[32m"64"[39m
                [33mmin[39m=[32m"1"[39m
                [33mstyle[39m=[32m"accent-color: var(--theme-primary);"[39m
                [33mtype[39m=[32m"range"[39m
                [33mvalue[39m=[32m"5"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-lg font-bold text-gray-900 dark:text-white w-12 text-center"[39m
                [33mid[39m=[32m"sample-size-value"[39m
              [36m>[39m
                [0m5[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-600 dark:text-gray-400"[39m
            [36m>[39m
              [0mLarger sizes produce more accurate color matching but ignore fine details[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"recent-colors-wrapper"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"colormatcher-filters-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"market-board-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"results-container"[39m
        [36m/>[39m
      [36m</div>[39m
    [36m</div>[39m
    [36m<div[39m
      [33mid[39m=[32m"test-container"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"space-y-8"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-4 text-center mb-8"[39m
        [36m>[39m
          [36m<h2[39m
            [33mclass[39m=[32m"text-2xl font-bold text-gray-900 dark:text-white flex items-center justify-center gap-2"[39m
          [36m>[39m
            [0mColor Matcher[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"[39m
          [36m>[39m
            [0mUpload an image or select a color to find the closest matching FFXIV dyes.[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"grid grid-cols-1 lg:grid-cols-2 gap-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mImage Upload[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"image-upload-container"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
            [36m>[39m
              [0mManual Color Input[0m
            [36m</h3>[39m
            [36m<div[39m
              [33mid[39m=[32m"color-picker-container"[39m
            [36m/>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"text-lg font-semibold text-gray-900 dark:text-white mb-4"[39m
          [36m>[39m
            [0mSample Settings[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-2"[39m
          [36m>[39m
            [36m<label[39m
              [33mclass[39m=[32m"block text-sm font-semibold text-gray-700 dark:text-gray-300"[39m
            [36m>[39m
              [0mSample Size (for image color averaging)[0m
              [36m<button[39m
                [33maria-describedby[39m=[32m"tooltip_1764635677361_dymu5vm"[39m
                [33maria-label[39m=[32m"More information"[39m
                [33mclass[39m=[32m"info-tooltip-icon inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full cursor-help transition-colors"[39m
                [33mdata-tooltip-id[39m=[32m"tooltip_1764635677361_dymu5vm"[39m
                [33mtabindex[39m=[32m"0"[39m
                [33mtype[39m=[32m"button"[39m
              [36m>[39m
                [0mâ“˜[0m
              [36m</button>[39m
            [36m</label>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center gap-4"[39m
            [36m>[39m
              [36m<input[39m
                [33mclass[39m=[32m"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none"[39m
                [33mid[39m=[32m"sample-size-input"[39m
                [33mmax[39m=[32m"64"[39m
                [33mmin[39m=[32m"1"[39m
                [33mstyle[39m=[32m"accent-color: var(--theme-primary);"[39m
                [33mtype[39m=[32m"range"[39m
                [33mvalue[39m=[32m"5"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-lg font-bold text-gray-900 dark:text-white w-12 text-center"[39m
                [33mid[39m=[32m"sample-size-value"[39m
              [36m>[39m
                [0m5[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-600 dark:text-gray-400"[39m
            [36m>[39m
              [0mLarger sizes produce more accurate color matching but ignore fine details[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"recent-colors-wrapper"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"colormatcher-filters-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mid[39m=[32m"market-board-container"[39m
          [36m/>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mid[39m=[32m"results-container"[39m
        [36m/>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
[36m [2mâ¯[22m src/components/__tests__/color-matcher-tool.test.ts:[2m1011:39[22m[39m
    [90m1009| [39m      [90m// Should show default error message[39m
    [90m1010| [39m      [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m1011| [39m        expect(toastServiceErrorMock).toHaveBeenCalledWith('Failed to â€¦
    [90m   | [39m                                      [31m^[39m
    [90m1012| [39m      })[33m;[39m
    [90m1013| [39m    })[33m;[39m
[90m [2mâ¯[22m runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:[2m47:12[22m[39m
[90m [2mâ¯[22m checkCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m124:77[22m[39m
[90m [2mâ¯[22m Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m118:16[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[28/28]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m28 failed[39m[22m[2m | [22m[1m[32m33 passed[39m[22m[90m (61)[39m
[2m   Start at [22m 19:34:33
[2m   Duration [22m 5.16s[2m (transform 461ms, setup 186ms, collect 788ms, tests 2.35s, environment 1.08s, prepare 21ms)[22m

